{% extends "base.html" %}

{% block bodysections %}
<section class="section">
    <div class="container">
        <div class="columns is-centered">
            <div class="column is-half">
                <nav class="breadcrumb" aria-label="breadcrumbs">
                    <ul>
                        <li><a href="{{ url_for('setup_wizard.wizard_start') }}">Setup</a></li>
                        <li class="is-active"><a href="#" aria-current="page">Credentials</a></li>
                        <li>Tournaments</li>
                        <li>Event Details</li>
                        <li>Complete</li>
                    </ul>
                </nav>

                <div class="card">
                    <div class="card-header">
                        <p class="card-header-title">
                            Step 1: TrueFinals API Credentials
                        </p>
                    </div>
                    <div class="card-content">
                        <form method="POST">
                            <div class="content">
                                <p>Enter your TrueFinals API credentials. You can find these in your TrueFinals account settings.</p>
                                
                                <div class="notification is-info is-light">
                                    <strong>Where to find your credentials:</strong>
                                    <ol>
                                        <li>Log into <a href="https://truefinals.com" target="_blank">TrueFinals.com</a></li>
                                        <li>Go to Account Settings</li>
                                        <li>Find the API section</li>
                                        <li>Copy your User ID and API Key</li>
                                    </ol>
                                </div>
                            </div>

                            <div class="field">
                                <label class="label" for="truefinals_user_id">TrueFinals User ID</label>
                                <div class="control">
                                    <input class="input" type="text" id="truefinals_user_id" name="truefinals_user_id" 
                                           value="{{ current_user_id }}" placeholder="Enter your TrueFinals user ID" required>
                                </div>
                            </div>

                            <div class="field">
                                <label class="label" for="truefinals_api_key">TrueFinals API Key</label>
                                <div class="control has-icons-right">
                                    <input class="input" type="password" id="truefinals_api_key" name="truefinals_api_key" 
                                           value="{{ current_api_key }}" placeholder="Enter your TrueFinals API key" required>
                                    <span class="icon is-small is-right" style="cursor: pointer;" onclick="togglePasswordVisibility('truefinals_api_key')">
                                        <i class="fas fa-eye" id="truefinals_api_key_icon"></i>
                                    </span>
                                </div>
                            </div>

                            <div class="field is-grouped">
                                <div class="control">
                                    <button class="button is-primary" type="submit">
                                        Save & Test Connection
                                    </button>
                                </div>
                                <div class="control">
                                    <a class="button is-light" href="{{ url_for('setup_wizard.wizard_start') }}">
                                        Back
                                    </a>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<script>
function togglePasswordVisibility(fieldId) {
    const field = document.getElementById(fieldId);
    const icon = document.getElementById(fieldId + '_icon');
    
    if (field.type === 'password') {
        field.type = 'text';
        icon.className = 'fas fa-eye-slash';
    } else {
        field.type = 'password';
        icon.className = 'fas fa-eye';
    }
}
</script>
{% endblock %}